# Задача 9.6: Создание страницы управления артефактами

## Описание
Разработать страницу управления артефактами в админ-панели, которая позволит просматривать, создавать, редактировать и удалять артефакты, а также загружать файлы артефактов в Firebase Storage.

## Конкретные шаги для Cursor
1. Расширить сервисный слой для работы с артефактами в админ-панели
2. Создать хуки для управления артефактами
3. Разработать компоненты для отображения списка артефактов
4. Реализовать формы для создания и редактирования артефактов с загрузкой файлов

## Промт для Cursor
```
Помоги мне создать страницу управления артефактами для админ-панели в проекте BizLevel.

Нам нужно создать функциональную страницу управления артефактами, которая позволит администраторам просматривать, создавать, редактировать и удалять артефакты, а также загружать файлы артефактов в Firebase Storage. Для этого выполним следующие шаги:

1. Расширь файл `src/lib/services/admin-service.ts`:
   - Добавь функции для работы с артефактами:
     - `getArtifactsAdmin(): Promise<Artifact[]>` - получение списка всех артефактов для админ-панели
     - `createArtifact(artifact: Omit<Artifact, 'id' | 'downloadCount' | 'uploadedAt'>, file: File): Promise<string>` - создание нового артефакта с загрузкой файла
     - `updateArtifact(artifactId: string, artifactData: Partial<Artifact>, file?: File): Promise<void>` - обновление артефакта и опционально замена файла
     - `deleteArtifact(artifactId: string): Promise<void>` - удаление артефакта и связанного файла
     - `resetDownloadCount(artifactId: string): Promise<void>` - сброс счетчика скачиваний артефакта

2. Создай файл `src/hooks/useAdminArtifacts.ts`:
   - Хук для работы с артефактами в админ-панели
   - Используй React Query для получения и кэширования данных
   - Реализуй:
     - `useAdminArtifacts()` - хук для получения списка всех артефактов
     - `useCreateArtifact()` - хук для создания нового артефакта
     - `useUpdateArtifact()` - хук для обновления артефакта
     - `useDeleteArtifact()` - хук для удаления артефакта
     - `useResetDownloadCount()` - хук для сброса счетчика скачиваний

3. Создай файл `src/components/admin/artifacts/ArtifactsList.tsx`:
   - Компонент для отображения списка артефактов
   - Должен использовать таблицу или карточки для отображения артефактов
   - Должен отображать ключевую информацию: название, описание, тип файла, связанный уровень, количество скачиваний
   - Должен иметь кнопки для редактирования, удаления и сброса счетчика скачиваний
   - Должен иметь возможность сортировки и фильтрации по типу файла или уровню
   - Должен обрабатывать состояния загрузки и ошибок
   - Должен использовать компоненты из shadcn/ui (Table или Card)

4. Создай файл `src/components/admin/artifacts/ArtifactFormDialog.tsx`:
   - Модальное окно с формой для создания/редактирования артефакта
   - Должно включать поля:
     - title - название артефакта
     - description - описание артефакта
     - levelId - связанный уровень (выпадающий список уровней)
     - file - загрузка файла артефакта
   - Должно отображать предпросмотр для загруженного файла (если возможно)
   - Должно валидировать данные с помощью Zod
   - Должно обрабатывать состояния загрузки и ошибок
   - Должно использовать компоненты из shadcn/ui (Dialog, Form)

5. Создай файл `src/components/admin/artifacts/FileUpload.tsx`:
   - Компонент для загрузки файла
   - Должен поддерживать drag-and-drop
   - Должен отображать прогресс загрузки
   - Должен проверять тип и размер файла
   - Должен отображать предпросмотр для загруженного файла (если возможно)
   - Должен использовать компоненты из shadcn/ui и Tailwind CSS

6. Создай файл `src/components/admin/artifacts/DeleteArtifactDialog.tsx`:
   - Модальное окно для подтверждения удаления артефакта
   - Должно предупреждать о необратимости действия
   - Должно обрабатывать состояния загрузки и ошибок
   - Должно использовать компоненты из shadcn/ui (AlertDialog)

7. Обнови страницу `src/app/(admin)/artifacts/page.tsx`:
   - Используй созданные компоненты для построения функциональной страницы
   - Добавь кнопку "Создать артефакт"
   - Интегрируй хуки для получения и управления данными
   - Добавь обработку ошибок и состояний загрузки

8. Создай файл `src/components/admin/artifacts/index.ts` для экспорта компонентов

Все компоненты должны:
- Использовать компоненты из shadcn/ui для стилизации
- Быть типизированы с использованием TypeScript
- Иметь адаптивный дизайн для разных размеров экрана
- Обрабатывать состояния загрузки и ошибок

Пожалуйста, создай указанные файлы и обнови страницу управления артефактами.

После выполнения задачи обнови status.md, указав, что задача 9.6 выполнена.
```

## Ожидаемый результат
- Обновленный файл `src/lib/services/admin-service.ts` с функциями для работы с артефактами
- Созданные файлы:
  - `src/hooks/useAdminArtifacts.ts`
  - `src/components/admin/artifacts/ArtifactsList.tsx`
  - `src/components/admin/artifacts/ArtifactFormDialog.tsx`
  - `src/components/admin/artifacts/FileUpload.tsx`
  - `src/components/admin/artifacts/DeleteArtifactDialog.tsx`
  - `src/components/admin/artifacts/index.ts`
- Обновленная страница `src/app/(admin)/artifacts/page.tsx`
- Работающая функциональность просмотра, создания, редактирования и удаления артефактов
- Загрузка файлов артефактов в Firebase Storage
- Возможность сброса счетчика скачиваний
- Обработка состояний загрузки и ошибок
- Обновленный файл status.md с отметкой о выполнении задачи 9.6

## Связь с другими задачами
- Эта задача следует за задачей 9.5: Создание страницы управления уровнями
- После выполнения этой задачи следует перейти к задаче 9.7: Реализация CRUD-операций для пользователей

## Обновление progress-tracking
После выполнения задачи обновите файл development-plan.md, заменив `[ ]` на `[x]` для этой задачи:
```
* [x] **task-9.6-create-artifact-management.md**: Создание страницы управления артефактами
```
