# Задача 7.1: Создание API Route для взаимодействия с OpenAI

## Описание
Создать API Route в Next.js для взаимодействия с OpenAI API, который будет обрабатывать запросы чата, отправлять их в OpenAI и возвращать ответы ассистента.


## Конкретные шаги для Cursor
1. Создать директорию `src/app/api/chat` (если она еще не создана)
2. Создать файл `src/app/api/chat/route.ts`
3. Реализовать обработчик POST-запросов для взаимодействия с OpenAI API
4. Настроить типы для запросов и ответов

## Промт для Cursor
```
Помоги мне создать API Route для взаимодействия с OpenAI в проекте BizLevel.

Нам нужно создать файл `src/app/api/chat/route.ts`, который будет обрабатывать POST-запросы, отправлять их в OpenAI API и возвращать ответы ассистента.

Файл должен:
1. Использовать Route Handlers из Next.js 14+ (App Router)
2. Принимать POST-запросы с историей сообщений
3. Отправлять запросы в OpenAI API (используя модель gpt-4-turbo или gpt-3.5-turbo)
4. Возвращать ответы ассистента
5. Обрабатывать ошибки и возвращать соответствующие HTTP-статусы

Для начала определим типы для запросов и ответов:
- Тип для сообщения: `{ role: 'user' | 'assistant', content: string }`
- Тип для запроса: `{ messages: Message[] }`
- Тип для ответа: `{ message: Message, error?: string }`

Затем реализуем обработчик POST запросов:
1. Получаем историю сообщений из тела запроса
2. Проверяем ключ API OpenAI из переменных окружения
3. Формируем запрос к OpenAI API
4. Отправляем запрос и получаем ответ
5. Возвращаем ответ ассистента

Также добавим контекст для ассистента, чтобы он понимал тематику BizLevel:
- Ассистент должен представиться как AI-помощник BizLevel
- Ассистент должен помогать с вопросами по бизнесу, предпринимательству, менеджменту
- Ассистент должен знать о платформе BizLevel и уровнях, которые пользователи проходят

Пожалуйста, создай файл `src/app/api/chat/route.ts` с указанной функциональностью.

После выполнения задачи обнови status.md, указав, что задача 7.1 выполнена.
```

## Ожидаемый результат
- Созданный файл `src/app/api/chat/route.ts`
- Реализованный обработчик POST-запросов для взаимодействия с OpenAI API
- Определенные типы для запросов и ответов
- Настроенный контекст для ассистента
- Обработка ошибок и возврат соответствующих HTTP-статусов
- Обновленный файл status.md с отметкой о выполнении задачи 7.1

## Связь с другими задачами
- Эта задача следует за задачей 6.7 и начинает Этап 7
- После выполнения этой задачи следует перейти к задаче 7.2: Безопасная настройка ключа API OpenAI в `.env.local`

## Обновление progress-tracking
После выполнения задачи обновите файл development-plan.md, заменив `[ ]` на `[x]` для этой задачи:
```
* [x] **task-7.1-create-chat-api-route.md**: Создание API Route (`src/app/api/chat/route.ts`) для взаимодействия с OpenAI
```
