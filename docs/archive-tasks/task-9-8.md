# Задача 9.8: Реализация CRUD-операций для уровней

## Описание
Реализовать полную функциональность CRUD-операций (Create, Read, Update, Delete) для управления уровнями в админ-панели, включая создание новых уровней, редактирование контента (видео, тесты) и упорядочивание уровней.

## Конкретные шаги для Cursor
1. Завершить разработку форм для создания и редактирования уровней
2. Реализовать управление видео-контентом уровней
3. Реализовать управление тестами и вопросами
4. Реализовать связывание уровней с артефактами
5. Разработать интерфейс для изменения порядка уровней

## Промт для Cursor
```
Помоги мне реализовать полную функциональность CRUD-операций для управления уровнями в админ-панели проекта BizLevel.

Нам нужно расширить существующую страницу управления уровнями, добавив возможность полноценного создания, редактирования и упорядочивания уровней, включая управление видео-контентом, тестами и связывание с артефактами. Для этого выполним следующие шаги:

1. Доработай файл `src/components/admin/levels/LevelFormDialog.tsx`:
   - Реализуй более детальную форму для создания/редактирования уровня
   - Разбей форму на вкладки для удобства: "Основная информация", "Видео", "Тесты", "Артефакты", "Критерии завершения"
   - Добавь возможность выбора навыков (SkillType) с помощью множественного выбора
   - Используй компоненты из shadcn/ui (Tabs, Form, Select)
   - Интегрируй компоненты VideoForm и TestForm

2. Обнови файл `src/components/admin/levels/VideoForm.tsx`:
   - Реализуй полноценную форму для добавления видео-контента
   - Добавь возможность предварительного просмотра видео по URL
   - Добавь валидацию URL на корректность
   - Добавь возможность изменения порядка видео в уровне (drag-and-drop)
   - Используй компоненты из shadcn/ui (Input, Button, Card)

3. Обнови файл `src/components/admin/levels/TestForm.tsx`:
   - Реализуй полноценную форму для добавления тестов
   - Добавь возможность создания и редактирования вопросов разных типов (single-choice, multiple-choice, text)
   - Реализуй интерфейс для выбора правильных ответов
   - Добавь валидацию (минимум один вопрос, правильные ответы для каждого вопроса)
   - Используй компоненты из shadcn/ui (Input, RadioGroup, Checkbox, Textarea)

4. Создай файл `src/components/admin/levels/QuestionForm.tsx`:
   - Компонент для создания/редактирования отдельного вопроса
   - Должен поддерживать разные типы вопросов
   - Должен включать поля: текст вопроса, варианты ответов, правильный ответ
   - Должен валидировать данные (минимум 2 варианта ответа для выбора, наличие правильного ответа)
   - Должен использовать компоненты из shadcn/ui (Input, RadioGroup, Checkbox)

5. Создай файл `src/components/admin/levels/ArtifactSelector.tsx`:
   - Компонент для выбора артефактов, связанных с уровнем
   - Должен отображать список доступных артефактов с возможностью выбора нескольких
   - Должен поддерживать поиск и фильтрацию артефактов
   - Должен использовать компоненты из shadcn/ui (MultiSelect, Checkbox)

6. Создай файл `src/components/admin/levels/CompletionCriteriaForm.tsx`:
   - Компонент для настройки критериев завершения уровня
   - Должен включать поля: количество необходимых видео, количество необходимых тестов
   - Должен валидировать данные (значения не больше фактического количества видео/тестов)
   - Должен использовать компоненты из shadcn/ui (Input, NumberInput)

7. Создай файл `src/components/admin/levels/LevelOrderManager.tsx`:
   - Компонент для изменения порядка уровней
   - Должен отображать список уровней с возможностью drag-and-drop для изменения порядка
   - Должен сохранять новый порядок в Firestore
   - Должен использовать библиотеку для drag-and-drop (например, dnd-kit) и компоненты из shadcn/ui

8. Создай файл `src/components/admin/levels/LevelDetailView.tsx`:
   - Компонент для просмотра детальной информации о уровне
   - Должен отображать все данные уровня: основную информацию, видео, тесты, артефакты, критерии завершения
   - Должен иметь кнопки для редактирования, удаления
   - Должен использовать компоненты из shadcn/ui (Tabs, Card)

9. Обнови страницу `src/app/(admin)/levels/page.tsx`:
   - Интегрируй все созданные компоненты
   - Добавь табы для переключения между разными представлениями (список, управление порядком)
   - Улучши UX и обработку ошибок

Все компоненты должны:
- Использовать компоненты из shadcn/ui для стилизации
- Быть типизированы с использованием TypeScript
- Иметь адаптивный дизайн для разных размеров экрана
- Обрабатывать состояния загрузки и ошибок
- Использовать toast-уведомления для обратной связи

Пожалуйста, создай и обнови указанные файлы для реализации полной функциональности CRUD-операций с уровнями.

После выполнения задачи обнови status.md, указав, что задача 9.8 выполнена.
```

## Ожидаемый результат
- Обновленные файлы:
  - `src/components/admin/levels/LevelFormDialog.tsx`
  - `src/components/admin/levels/VideoForm.tsx`
  - `src/components/admin/levels/TestForm.tsx`
  - `src/app/(admin)/levels/page.tsx`
- Созданные файлы:
  - `src/components/admin/levels/QuestionForm.tsx`
  - `src/components/admin/levels/ArtifactSelector.tsx`
  - `src/components/admin/levels/CompletionCriteriaForm.tsx`
  - `src/components/admin/levels/LevelOrderManager.tsx`
  - `src/components/admin/levels/LevelDetailView.tsx`
- Полная функциональность CRUD-операций с уровнями
- Управление видео-контентом, тестами и связывание с артефактами
- Изменение порядка уровней через drag-and-drop
- Улучшенный UX и обработка ошибок
- Обновленный файл status.md с отметкой о выполнении задачи 9.8

## Связь с другими задачами
- Эта задача следует за задачей 9.7: Реализация CRUD-операций для пользователей
- После выполнения этой задачи следует перейти к задаче 9.9: Реализация CRUD-операций для артефактов

## Обновление progress-tracking
После выполнения задачи обновите файл development-plan.md, заменив `[ ]` на `[x]` для этой задачи:
```
* [x] **task-9.8-implement-level-crud.md**: Реализация CRUD-операций для уровней
```
