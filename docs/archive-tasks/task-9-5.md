# Задача 9.5: Создание страницы управления уровнями

## Описание
Разработать страницу управления уровнями в админ-панели, которая позволит просматривать, создавать, редактировать и удалять уровни обучения.


## Конкретные шаги для Cursor
1. Расширить сервисный слой для работы с уровнями в админ-панели
2. Создать хуки для управления уровнями
3. Разработать компоненты для отображения списка уровней
4. Реализовать формы для создания и редактирования уровней

## Промт для Cursor
```
Помоги мне создать страницу управления уровнями для админ-панели в проекте BizLevel.

Нам нужно создать функциональную страницу управления уровнями, которая позволит администраторам просматривать, создавать, редактировать и удалять уровни обучения. Для этого выполним следующие шаги:

1. Расширь файл `src/lib/services/admin-service.ts`:
   - Добавь функции для работы с уровнями:
     - `getLevelsAdmin(): Promise<Level[]>` - получение списка всех уровней для админ-панели
     - `createLevel(level: Omit<Level, 'id'>): Promise<string>` - создание нового уровня
     - `updateLevel(levelId: string, levelData: Partial<Level>): Promise<void>` - обновление уровня
     - `deleteLevel(levelId: string): Promise<void>` - удаление уровня
     - `reorderLevels(levelIds: string[]): Promise<void>` - изменение порядка уровней

2. Создай файл `src/hooks/useAdminLevels.ts`:
   - Хук для работы с уровнями в админ-панели
   - Используй React Query для получения и кэширования данных
   - Реализуй:
     - `useAdminLevels()` - хук для получения списка всех уровней
     - `useCreateLevel()` - хук для создания нового уровня
     - `useUpdateLevel()` - хук для обновления уровня
     - `useDeleteLevel()` - хук для удаления уровня
     - `useReorderLevels()` - хук для изменения порядка уровней

3. Создай файл `src/components/admin/levels/LevelsList.tsx`:
   - Компонент для отображения списка уровней
   - Должен использовать таблицу или карточки для отображения уровней
   - Должен отображать ключевую информацию: название, описание, порядок, количество видео и тестов
   - Должен иметь кнопки для редактирования и удаления
   - Должен поддерживать drag-and-drop для изменения порядка уровней
   - Должен обрабатывать состояния загрузки и ошибок
   - Должен использовать компоненты из shadcn/ui (Table или Card)

4. Создай файл `src/components/admin/levels/LevelFormDialog.tsx`:
   - Модальное окно с формой для создания/редактирования уровня
   - Должно включать поля:
     - title - название уровня
     - description - описание уровня
     - order - порядок (можно автоматически предлагать следующий номер)
     - videoContent - массив видео (возможность добавления нескольких)
     - tests - массив тестов (возможность добавления нескольких)
     - relatedArtifactIds - связанные артефакты (множественный выбор)
     - skillFocus - фокус на навыках (множественный выбор)
     - completionCriteria - критерии завершения
   - Должно валидировать данные с помощью Zod
   - Должно обрабатывать состояния загрузки и ошибок
   - Должно использовать компоненты из shadcn/ui (Dialog, Form)

5. Создай файл `src/components/admin/levels/DeleteLevelDialog.tsx`:
   - Модальное окно для подтверждения удаления уровня
   - Должно предупреждать о необратимости действия и последствиях для пользователей
   - Должно обрабатывать состояния загрузки и ошибок
   - Должно использовать компоненты из shadcn/ui (AlertDialog)

6. Создай файл `src/components/admin/levels/VideoForm.tsx`:
   - Компонент для добавления/редактирования видео в уровне
   - Должен включать поля: id, title, url, duration
   - Должен поддерживать удаление видео
   - Должен использовать компоненты из shadcn/ui (Input, Button)

7. Создай файл `src/components/admin/levels/TestForm.tsx`:
   - Компонент для добавления/редактирования тестов в уровне
   - Должен включать поля: id, title, questions (массив вопросов)
   - Должен поддерживать добавление/удаление вопросов
   - Должен использовать компоненты из shadcn/ui (Input, Button)

8. Обнови страницу `src/app/(admin)/levels/page.tsx`:
   - Используй созданные компоненты для построения функциональной страницы
   - Добавь кнопку "Создать уровень"
   - Интегрируй хуки для получения и управления данными
   - Добавь обработку ошибок и состояний загрузки

9. Создай файл `src/components/admin/levels/index.ts` для экспорта компонентов

Все компоненты должны:
- Использовать компоненты из shadcn/ui для стилизации
- Быть типизированы с использованием TypeScript
- Иметь адаптивный дизайн для разных размеров экрана
- Обрабатывать состояния загрузки и ошибок

Пожалуйста, создай указанные файлы и обнови страницу управления уровнями.

После выполнения задачи обнови status.md, указав, что задача 9.5 выполнена.
```

## Ожидаемый результат
- Обновленный файл `src/lib/services/admin-service.ts` с функциями для работы с уровнями
- Созданные файлы:
  - `src/hooks/useAdminLevels.ts`
  - `src/components/admin/levels/LevelsList.tsx`
  - `src/components/admin/levels/LevelFormDialog.tsx`
  - `src/components/admin/levels/DeleteLevelDialog.tsx`
  - `src/components/admin/levels/VideoForm.tsx`
  - `src/components/admin/levels/TestForm.tsx`
  - `src/components/admin/levels/index.ts`
- Обновленная страница `src/app/(admin)/levels/page.tsx`
- Работающая функциональность просмотра, создания, редактирования и удаления уровней
- Поддержка drag-and-drop для изменения порядка уровней
- Обработка состояний загрузки и ошибок
- Обновленный файл status.md с отметкой о выполнении задачи 9.5

## Связь с другими задачами
- Эта задача следует за задачей 9.4: Создание страницы управления пользователями
- После выполнения этой задачи следует перейти к задаче 9.6: Создание страницы управления артефактами

## Обновление progress-tracking
После выполнения задачи обновите файл development-plan.md, заменив `[ ]` на `[x]` для этой задачи:
```
* [x] **task-9.5-create-level-management.md**: Создание страницы управления уровнями
```
