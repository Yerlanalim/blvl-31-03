# Задача 9.9: Реализация CRUD-операций для артефактов

## Описание
Реализовать полную функциональность CRUD-операций (Create, Read, Update, Delete) для управления артефактами в админ-панели, включая загрузку файлов, связывание с уровнями и отслеживание статистики скачиваний.


## Конкретные шаги для Cursor
1. Завершить разработку форм для создания и редактирования артефактов
2. Улучшить компонент загрузки файлов
3. Реализовать просмотр детальной информации об артефакте
4. Добавить отображение статистики скачиваний
5. Реализовать связывание артефактов с уровнями

## Промт для Cursor
```
Помоги мне реализовать полную функциональность CRUD-операций для управления артефактами в админ-панели проекта BizLevel.

Нам нужно расширить существующую страницу управления артефактами, добавив возможность полноценного создания, редактирования и управления артефактами, включая загрузку файлов, связывание с уровнями и отслеживание статистики скачиваний. Для этого выполним следующие шаги:

1. Доработай файл `src/components/admin/artifacts/ArtifactFormDialog.tsx`:
   - Реализуй более детальную форму для создания/редактирования артефакта
   - Разбей форму на секции: "Основная информация", "Файл", "Связанный уровень"
   - Добавь выбор уровня из выпадающего списка
   - Интегрируй улучшенный компонент FileUpload
   - Используй компоненты из shadcn/ui (Form, Select, Input)

2. Улучши файл `src/components/admin/artifacts/FileUpload.tsx`:
   - Добавь проверку типов файлов (PDF, DOCX, XLSX, и т.д.)
   - Добавь ограничение размера файла
   - Реализуй отображение прогресса загрузки
   - Добавь предпросмотр для поддерживаемых типов файлов (PDF, изображения)
   - Добавь возможность удаления выбранного файла
   - Используй компоненты из shadcn/ui и Tailwind CSS

3. Создай файл `src/components/admin/artifacts/ArtifactDetailView.tsx`:
   - Компонент для просмотра детальной информации об артефакте
   - Должен отображать:
     - Основную информацию (название, описание, тип файла)
     - Связанный уровень
     - Количество скачиваний
     - График скачиваний по времени (можно использовать recharts)
     - Кнопку для скачивания файла
   - Должен иметь кнопки для редактирования, удаления, сброса счетчика скачиваний
   - Должен использовать компоненты из shadcn/ui (Card, Tabs)

4. Создай файл `src/components/admin/artifacts/DownloadStatsView.tsx`:
   - Компонент для отображения статистики скачиваний
   - Должен отображать:
     - Общее количество скачиваний
     - График скачиваний по времени (если доступно)
     - Список пользователей, скачавших артефакт (если доступно)
   - Должен использовать компоненты из shadcn/ui (Card, Table)

5. Обнови файл `src/components/admin/artifacts/ArtifactsList.tsx`:
   - Добавь возможность группировки артефактов по уровням
   - Добавь фильтрацию по типу файла и уровню
   - Добавь сортировку по названию, дате загрузки, количеству скачиваний
   - Добавь кнопку для просмотра детальной информации об артефакте
   - Добавь индикаторы для отображения типа файла (иконки для PDF, DOCX, XLSX и т.д.)
   - Используй компоненты из shadcn/ui (Table, Select, Input)

6. Расширь или обнови администраторский сервис `src/lib/services/admin-service.ts`:
   - Добавь функцию для получения статистики скачиваний артефакта по времени
   - Добавь функцию для получения списка пользователей, скачавших артефакт
   - Добавь функцию для обновления связей артефакта с уровнями

7. Обнови страницу `src/app/(admin)/artifacts/page.tsx`:
   - Интегрируй все созданные компоненты
   - Добавь табы для переключения между разными представлениями (список, статистика)
   - Улучши UX и обработку ошибок

Все компоненты должны:
- Использовать компоненты из shadcn/ui для стилизации
- Быть типизированы с использованием TypeScript
- Иметь адаптивный дизайн для разных размеров экрана
- Обрабатывать состояния загрузки и ошибок
- Использовать toast-уведомления для обратной связи

Пожалуйста, создай и обнови указанные файлы для реализации полной функциональности CRUD-операций с артефактами.

После выполнения задачи обнови status.md, указав, что задача 9.9 выполнена.
```

## Ожидаемый результат
- Обновленные файлы:
  - `src/components/admin/artifacts/ArtifactFormDialog.tsx`
  - `src/components/admin/artifacts/FileUpload.tsx`
  - `src/components/admin/artifacts/ArtifactsList.tsx`
  - `src/lib/services/admin-service.ts`
  - `src/app/(admin)/artifacts/page.tsx`
- Созданные файлы:
  - `src/components/admin/artifacts/ArtifactDetailView.tsx`
  - `src/components/admin/artifacts/DownloadStatsView.tsx`
- Полная функциональность CRUD-операций с артефактами
- Улучшенный компонент загрузки файлов с проверкой типов и размера
- Отображение статистики скачиваний
- Связывание артефактов с уровнями
- Улучшенный UX и обработка ошибок
- Обновленный файл status.md с отметкой о выполнении задачи 9.9

## Связь с другими задачами
- Эта задача следует за задачей 9.8: Реализация CRUD-операций для уровней
- После выполнения этой задачи следует перейти к задаче 9.10: Настройка прямого взаимодействия с Firebase из админ-панели

## Обновление progress-tracking
После выполнения задачи обновите файл development-plan.md, заменив `[ ]` на `[x]` для этой задачи:
```
* [x] **task-9.9-implement-artifact-crud.md**: Реализация CRUD-операций для артефактов
```
