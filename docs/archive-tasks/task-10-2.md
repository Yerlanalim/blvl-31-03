# Задача 10.2: Написание юнит-тестов для ключевых компонентов

## Описание
Разработать и реализовать юнит-тесты для ключевых компонентов проекта BizLevel, обеспечивая базовое покрытие тестами и проверку работоспособности основной функциональности.

## Ссылки на документацию
- [Этап 10, Шаг 2](../development-plan.md): Написание юнит-тестов для ключевых компонентов
- [Раздел 2: Технологический Стек](../bizlevel-project-context.md): Тестирование: Jest / Vitest + React Testing Library

## Конкретные шаги для Cursor
1. Создать тесты для UI компонентов (Button, Card, Form)
2. Создать тесты для компонентов аутентификации
3. Создать тесты для компонентов карты уровней
4. Создать тесты для хуков и сервисов 
5. Настроить моки для зависимостей

## Промт для Cursor
```
Помоги мне написать юнит-тесты для ключевых компонентов проекта BizLevel, используя Vitest и React Testing Library.

Мы уже настроили среду тестирования в предыдущей задаче, теперь нам нужно создать набор тестов для основных компонентов. Давай сделаем следующее:

1. Создадим тесты для базовых компонентов UI:
   - Создай директорию `src/components/ui/__tests__` (если еще не создана)
   - Напиши тест для компонента Button, проверяющий:
     - Рендеринг кнопки с разными вариантами (primary, outline, ghost)
     - Клик по кнопке и вызов обработчика события
     - Проверку атрибутов disabled, size и class
   - Напиши тест для компонента Card, проверяющий корректный рендеринг
   - Напиши тест для компонента Form, проверяющий базовую функциональность

2. Создадим тесты для компонентов аутентификации:
   - Создай директорию `src/components/auth/__tests__`
   - Напиши тест для компонента LoginForm, проверяющий:
     - Рендеринг формы
     - Отображение ошибок валидации
     - Отправку формы с валидными данными
     - Отображение ошибок сервера (используя моки)
   - Напиши тест для компонента RegisterForm с аналогичными проверками

3. Создадим тесты для компонентов карты уровней:
   - Создай директорию `src/components/features/LevelMap/__tests__`
   - Напиши тест для компонента LevelCard, проверяющий корректный рендеринг и поведение
   - Напиши тест для компонента LevelMap, проверяющий отображение уровней и их статусов
   - Используй моки для данных уровней и прогресса пользователя

4. Создадим тесты для основных хуков:
   - Создай директорию `src/hooks/__tests__`
   - Напиши тест для хука useAuth, проверяющий его поведение
   - Напиши тест для хука useProgress, проверяющий корректную работу с данными
   - Используй библиотеку @testing-library/react-hooks для тестирования хуков

5. Создадим тесты для сервисных функций:
   - Создай директорию `src/lib/services/__tests__`
   - Напиши тест для level-service.ts, проверяющий работу функций получения данных
   - Напиши тест для progress-service.ts, проверяющий функции обновления прогресса
   - Используй моки для Firestore и других зависимостей

Во всех тестах используй нашу вспомогательную функцию render из src/test/utils.tsx для рендеринга компонентов с необходимыми провайдерами.

Для мокирования API используй vitest-mock-extended или встроенные возможности Vitest.

После создания базового набора тестов, запусти их командой npm run test:coverage для проверки покрытия.
```

## Ожидаемый результат
- Созданные тесты для базовых UI компонентов
- Созданные тесты для компонентов аутентификации
- Созданные тесты для компонентов карты уровней
- Созданные тесты для основных хуков
- Созданные тесты для сервисных функций
- Базовое покрытие кода тестами (минимум 50%)
- Все тесты проходят успешно
- Обновленный файл status.md с отметкой о выполнении задачи 10.2

## Связь с другими задачами
- Эта задача следует за задачей 10.1: Настройка среды тестирования
- После выполнения этой задачи следует перейти к задаче 10.3: Реализация обратной связи с пользователем

## Обновление progress-tracking
После выполнения задачи обновите файл development-plan.md, заменив `[ ]` на `[x]` для этой задачи:
```
* [x] **task-10.2-write-component-tests.md**: Написание юнит-тестов для ключевых компонентов
``` 